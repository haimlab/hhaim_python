import sys

BINDING_EFFICIENCY_TABLE = {
    'A': {295: -0.843340826, 332: -0.464049395, 339: -0.786797717, 392: -0.844863301, 448: -0.261470213, 662: -0.372349788, 663: -0.507757909, 664: -0.619648927, 665: -1.509782697, 667: 0},
    'C': {295: -0.843340826, 332: -0.464049395, 339: -0.786797717, 392: -0.844863301, 448: -0.261470213, 662: -0.425078787, 663: -0.507757909, 664: -0.619648927, 665: -1.509782697, 667: -0.519362929},
    'D': {295: -0.918103409, 332: -1.403275213, 339: -0.073291563, 392: -1.368665877, 448: -0.167511055, 662: 0, 663: -0.507757909, 664: 0, 665: -1.849974311, 667: -1.569436786},
    'E': {295: -0.639319686, 332: -0.733585381, 339: -0.136060422, 392: -1.368665877, 448: -0.167511055, 662: 0, 663: -0.507757909, 664: -0.66012111, 665: -1.849974311, 667: -1.058965506},
    'F': {295: -0.843340826, 332: -0.464049395, 339: -0.048477874, 392: -0.844863301, 448: -0.261470213, 662: -0.425078787, 663: -0.507757909, 664: -0.619648927, 665: -1.509782697, 667: -0.519362929},
    'G': {295: -0.843340826, 332: -0.464049395, 339: -1.46648923, 392: -0.844863301, 448: -0.261470213, 662: -0.533136133, 663: -0.507757909, 664: -1.293791002, 665: -1.509782697, 667: -0.337428085},
    'H': {295: -1.386786226, 332: -0.776090809, 339: -0.479884004, 392: -1.299082897, 448: -0.167511055, 662: -0.516994474, 663: -0.507757909, 664: -0.330060555, 665: -0.193703071, 667: -0.148725267},
    'I': {295: -0.843340826, 332: 0.294077564, 339: -1.32674822, 392: -0.844863301, 448: -0.261470213, 662: -0.425078787, 663: -0.507757909, 664: -0.619648927, 665: -1.509782697, 667: -0.519362929},
    'K': {295: -1.024623924, 332: -0.776090809, 339: -0.256214696, 392: -1.299082897, 448: -0.167511055, 662: -0.516994474, 663: -0.507757909, 664: -0.330060555, 665: 0, 667: -0.148725267},
    'L': {295: -1.156683389, 332: -0.464049395, 339: -0.786797717, 392: -0.844863301, 448: -0.261470213, 662: -0.425078787, 663: 0, 664: -0.619648927, 665: -1.509782697, 667: -0.519362929},
    'M': {295: -0.843340826, 332: -0.464049395, 339: -0.786797717, 392: -0.844863301, 448: -0.261470213, 662: -0.425078787, 663: -0.507757909, 664: -0.619648927, 665: -1.509782697, 667: -0.519362929},
    'N': {295: -1.053210671, 332: -0.783976913, 339: -0.308168907, 392: -1.110448535, 448: -0.13693026, 662: -0.388352377, 663: -0.507757909, 664: -0.789869804, 665: -1.552458901, 667: -0.739641097},
    'P': {295: -0.843340826, 332: -0.464049395, 339: -0.786797717, 392: -0.844863301, 448: -0.261470213, 662: -0.425078787, 663: -0.507757909, 664: -0.619648927, 665: -1.509782697, 667: -0.519362929},
    'Q': {295: -0.843340826, 332: -0.464049395, 339: -0.786797717, 392: -0.844863301, 448: -0.635090071, 662: -0.369750442, 663: -0.507757909, 664: -0.619648927, 665: -1.657368255, 667: -1.220660701},
    'R': {295: -1.205705075, 332: -0.776090809, 339: -0.703553313, 392: -1.299082897, 448: -0.167511055, 662: -0.516994474, 663: -0.507757909, 664: -0.330060555, 665: -0.387406143, 667: -0.148725267},
    'S': {295: -0.172860397, 332: -0.716758382, 339: -0.052405186, 392: -0.638220096, 448: 0.265818094, 662: -0.75671666, 663: -0.507757909, 664: 0, 665: -0.93365723, 667: -0.213133914},
    'T': {295: -0.990608845, 332: -0.64953985, 339: -2.137180921, 392: -0.785921271, 448: -0.539678614, 662: -0.019988095, 663: -0.507757909, 664: -0.394934902, 665: -1.895646403, 667: -0.288644687},
    'V': {295: -0.843340826, 332: -0.464049395, 339: -0.786797717, 392: -0.844863301, 448: -0.261470213, 662: -0.425078787, 663: -0.507757909, 664: -0.619648927, 665: -1.509782697, 667: -0.519362929},
    'W': {295: -0.843340826, 332: -0.464049395, 339: -0.786797717, 392: -0.844863301, 448: -0.261470213, 662: -0.425078787, 663: -1.015515817, 664: -0.619648927, 665: -1.509782697, 667: -0.519362929},
    'Y': {295: -0.843340826, 332: -0.464049395, 339: -0.305475543, 392: -0.844863301, 448: -0.261470213, 662: -0.425078787, 663: -0.507757909, 664: -0.619648927, 665: -1.509782697, 667: -0.519362929},
    'Z': {295: 0, 332: 0, 339: 0, 392: 0, 448: 0}
}

HYDROPATHY_SCORE_TABLE = {
    'A': 0.68,
    'C': 0.733,
    'D': 0.19,
    'E': 0.203,
    'F': 1,
    'G': 0.584,
    'H': 0.304,
    'I': 0.958,
    'K': 0.403,
    'L': 0.953,
    'M': 0.782,
    'N': 0.363,
    'P': 0.759,
    'Q': 0.376,
    'R': 0.167,
    'S': 0.466,
    'T': 0.542,
    'V': 0.854,
    'W': 0.898,
    'Y': 0.900,
    'Z': 0,
    '-': 1.5
}

def errTableStr(table):
    return "Table: " + table + " does not exist"

def errLookupStr(pos, letter, table):
    return "Value does not exist for positoin: " + str(pos) + ", letter: " + str(letter) + ", table: " + str(table)

def lookup(aminoAcid, position, tableName):
    try:
        if tableName.lower() == 'bindingefficiency':
            return BINDING_EFFICIENCY_TABLE[aminoAcid][position]
        elif tableName.lower() == 'hydropathy':
            return HYDROPATHY_SCORE_TABLE[aminoAcid]
        else:
            raise Exception(errTableStr(tableName))
    except KeyError:
        sys.exit(errLookupStr(position, aminoAcid, tableName))

