BINDING_EFFICIENCY_TABLE_2G12 = {
    'A': {295: -0.843340826, 332: -0.464049395, 339: -0.786797717, 392: -0.844863301, 448: -0.261470213},
    'C': {295: -0.843340826, 332: -0.464049395, 339: -0.786797717, 392: -0.844863301, 448: -0.261470213},
    'D': {295: -0.918103409, 332: -1.403275213, 339: -0.073291563, 392: -1.368665877, 448: -0.167511055},
    'E': {295: -0.639319686, 332: -0.733585381, 339: -0.136060422, 392: -1.368665877, 448: -0.167511055},
    'F': {295: -0.843340826, 332: -0.464049395, 339: -0.048477874, 392: -0.844863301, 448: -0.261470213},
    'G': {295: -0.843340826, 332: -0.464049395, 339: -1.46648923, 392: -0.844863301, 448: -0.261470213},
    'H': {295: -1.386786226, 332: -0.776090809, 339: -0.479884004, 392: -1.299082897, 448: -0.167511055},
    'I': {295: -0.843340826, 332: 0.294077564, 339: -1.32674822, 392: -0.844863301, 448: -0.261470213},
    'K': {295: -1.024623924, 332: -0.776090809, 339: -0.256214696, 392: -1.299082897, 448: -0.167511055},
    'L': {295: -1.156683389, 332: -0.464049395, 339: -0.786797717, 392: -0.844863301, 448: -0.261470213},
    'M': {295: -0.843340826, 332: -0.464049395, 339: -0.786797717, 392: -0.844863301, 448: -0.261470213},
    'N': {295: -1.053210671, 332: -0.783976913, 339: -0.308168907, 392: -1.110448535, 448: -0.13693026},
    'P': {295: -0.843340826, 332: -0.464049395, 339: -0.786797717, 392: -0.844863301, 448: -0.261470213},
    'Q': {295: -0.843340826, 332: -0.464049395, 339: -0.786797717, 392: -0.844863301, 448: -0.635090071},
    'R': {295: -1.205705075, 332: -0.776090809, 339: -0.703553313, 392: -1.299082897, 448: -0.167511055},
    'S': {295: -0.172860397, 332: -0.716758382, 339: -0.052405186, 392: -0.638220096, 448: 0.265818094},
    'T': {295: -0.990608845, 332: -0.64953985, 339: -2.137180921, 392: -0.785921271, 448: -0.539678614},
    'V': {295: -0.843340826, 332: -0.464049395, 339: -0.786797717, 392: -0.844863301, 448: -0.261470213},
    'W': {295: -0.843340826, 332: -0.464049395, 339: -0.786797717, 392: -0.844863301, 448: -0.261470213},
    'Y': {295: -0.843340826, 332: -0.464049395, 339: -0.305475543, 392: -0.844863301, 448: -0.261470213},
    'Z': {295: 0, 332: 0, 339: 0, 392: 0, 448: 0}
}

BINDING_EFFICIENCY_TABLE_2F5 = {
    'A': {662: -0.372349788, 663: -0.507757909, 664: -0.619648927, 665: -1.509782697, 667: 0},
    'C': {662: -0.425078787, 663: -0.507757909, 664: -0.619648927, 665: -1.509782697, 667: -0.519362929},
    'D': {662: 0, 663: -0.507757909, 664: 0, 665: -1.849974311, 667: -1.569436786},
    'E': {662: 0, 663: -0.507757909, 664: -0.66012111, 665: -1.849974311, 667: -1.058965506},
    'F': {662: -0.425078787, 663: -0.507757909, 664: -0.619648927, 665: -1.509782697, 667: -0.519362929},
    'G': {662: -0.533136133, 663: -0.507757909, 664: -1.293791002, 665: -1.509782697, 667: -0.337428085},
    'H': {662: -0.516994474, 663: -0.507757909, 664: -0.330060555, 665: -0.193703071, 667: -0.148725267},
    'I': {662: -0.425078787, 663: -0.507757909, 664: -0.619648927, 665: -1.509782697, 667: -0.519362929},
    'K': {662: -0.516994474, 663: -0.507757909, 664: -0.330060555, 665: 0, 667: -0.148725267},
    'L': {662: -0.425078787, 663: 0, 664: -0.619648927, 665: -1.509782697, 667: -0.519362929},
    'M': {662: -0.425078787, 663: -0.507757909, 664: -0.619648927, 665: -1.509782697, 667: -0.519362929},
    'N': {662: -0.388352377, 663: -0.507757909, 664: -0.789869804, 665: -1.552458901, 667: -0.739641097},
    'P': {662: -0.425078787, 663: -0.507757909, 664: -0.619648927, 665: -1.509782697, 667: -0.519362929},
    'Q': {662: -0.369750442, 663: -0.507757909, 664: -0.619648927, 665: -1.657368255, 667: -1.220660701},
    'R': {662: -0.516994474, 663: -0.507757909, 664: -0.330060555, 665: -0.387406143, 667: -0.148725267},
    'S': {662: -0.75671666, 663: -0.507757909, 664: 0, 665: -0.93365723, 667: -0.213133914},
    'T': {662: -0.019988095, 663: -0.507757909, 664: -0.394934902, 665: -1.895646403, 667: -0.288644687},
    'V': {662: -0.425078787, 663: -0.507757909, 664: -0.619648927, 665: -1.509782697, 667: -0.519362929},
    'W': {662: -0.425078787, 663: -1.015515817, 664: -0.619648927, 665: -1.509782697, 667: -0.519362929},
    'Y': {662: -0.425078787, 663: -0.507757909, 664: -0.619648927, 665: -1.509782697, 667: -0.519362929}
}

HYDROPATHY_SCORE_TABLE = {
    'A': 68.0,
    'C': 73.3,
    'D': 19.0,
    'E': 20.3,
    'F': 100.0,
    'G': 58.4,
    'H': 30.4,
    'I': 95.8,
    'K': 40.3,
    'L': 95.3,
    'M': 78.2,
    'N': 36.3,
    'P': 75.9,
    'Q': 37.6,
    'R': 16.7,
    'S': 46.6,
    'T': 54.2,
    'V': 85.4,
    'W': 89.8,
    'Y': 90.0,
    'Z': 0.0,
    '-': 150.0
}

BINDING_EFFICIENCY_NOT_EXIST = 'Binding Efficiency not available'
HYDROPATHY_NOT_EXIST = 'Hydropathy score not available'
POSTION_NOT_NEEDED = 'Please note that Hydropathy scores used during calculations are independent of position'
TABLE_NOT_EXIST = 'The requested table does not exist'


# lookup functions
def lookup2G12(aminoAcid, position):
    try:
        return BINDING_EFFICIENCY_TABLE_2G12[aminoAcid][position]
    except KeyError:
        raise Exception(BINDING_EFFICIENCY_NOT_EXIST)


def lookup2F5(aminoAcid, position):
    try:
        return BINDING_EFFICIENCY_TABLE_2F5[aminoAcid][position]
    except KeyError:
        raise Exception(BINDING_EFFICIENCY_NOT_EXIST)


def lookupHydropathy(aminoAcid, position=None):
    if position is not None:
        print(POSTION_NOT_NEEDED)
    try:
        return HYDROPATHY_SCORE_TABLE[aminoAcid]
    except KeyError:
        raise Exception(HYDROPATHY_NOT_EXIST)


def lookup(aminoAcid, position, tableName):
    if tableName == '2G12':
        return lookup2G12(aminoAcid, position)
    elif tableName == '2F5':
        return lookup2F5(aminoAcid, position)
    elif tableName == 'Hydropathy':
        return lookupHydropathy(aminoAcid)
    else:
        raise Exception(TABLE_NOT_EXIST)
